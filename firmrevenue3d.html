<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        /* Make the plot take up the entire page */
        body, html, #myDiv {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>

<div id="myDiv"></div>

<script>
// Load the data from the JSON file
fetch('firms_data.json')
    .then(response => response.json())
    .then(data => {
        // Create the trace for the 3D scatter plot
        var trace = {
            x: data['Revenue'],
            y: data['Lawyers'],
            z: data['RevenuePerLawyer'],
            marker: {
                color: data['RevenuePerLawyer'],  // Color based on revenue per lawyer
                colorscale: [[0, 'lightblue'], [1, 'navy']],
                opacity: 0.8,
                size: data['RevenuePerLawyer'],  // Size based on revenue per lawyer
                sizemode: 'diameter',  // Size represents the diameter of the marker
                sizeref: 20000,  // Adjust the scale of the marker size
                colorbar: {
                    title: { text: 'Revenue Per Lawyer' },
                    x: -0.1
                }
            },
            mode: 'markers',
            name: 'Top 100 Law Firms (Darker color & bigger size = higher Revenue Per Lawyer)',
            type: 'scatter3d',
            hovertemplate:
                '<b>%{text}</b><br>' +
                'Total Revenue: %{x}<br>' +
                'Total Lawyers: %{y}<br>' +
                'Revenue Per Lawyer: %{z}<br>' +
                '<extra></extra>',  // Hide secondary hover box
            text: data['Firm']  // Show firm name when a marker is hovered
        };

        var layout = {
            title: '3D Visualization of Top 100 Law Firms by Revenue',
            scene: {
                xaxis: { title: 'Total Revenue' },
                yaxis: { title: 'Total Lawyers' },
                zaxis: { title: 'Revenue Per Lawyer' },
            },
            autosize: true,  // Automatically size the plot to fit the div
            height: window.innerHeight,  // Set the height to the height of the browser window
            width: window.innerWidth  // Set the width to the width of the browser window
        };

        // Create the data array
        var plotData = [trace];

        // Plot the data
        Plotly.newPlot('myDiv', plotData, layout);

        // Resize the plot when the window size changes
        window.onresize = function() {
            Plotly.relayout('myDiv', {
                'width': window.innerWidth,
                'height': window.innerHeight
            });
        };
    });
</script>

</body>
</html>
